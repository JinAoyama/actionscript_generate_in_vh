# Automatic Action Script Generation to Improve Execution Rate based on LLM in VirtualHome
## Set Up (VirtualHome)
1. [VirtualHome](https://github.com/xavierpuigf/virtualhome) Setup
2. Refer to VirtualHome's Github to confirm that it works properly.

## Set Up (VirtualHome AIST)
1. [VirtualHome_aist](https://github.com/aistairc/virtualhome_aist/) Setup
2. Refer to virtualhome_aist's Github to confirm that it works properly.
3. Note that the simulator is different from the original VirtualHome. The simulator can be downloaded [here](https://github.com/aistairc/virtualhome_unity_aist/releases/tag/Door_Modified_Build_2023_0404/).

※ Note that the original VirtualHome and VirtualHome AIST have different python execution environments.

## How to execute the our system (VirtualHome Original)
1. Download the original_vh_program folder and put it under (virtualhome/).
2. Run VirtualHome.exe. (virtualhome/simulation/unity_simulator/VirtualHome.exe)
3. Open the jupyter file(original_vh_program.ipynb) and run it from the top. Put any action description in the last cell and run it to generate the action script.

※ Note that the [OpenAI](https://openai.com/) API is required for execution.

## How to execute the our system (VirtualHome AIST)
1. Download the aist_vh_program folder and put it under (virtualhome_aist/).
2. Run VirtualHome.exe. (virtualhome_aist/simulation/unity_simulator/VirtualHome.exe)
3. Open the jupyter file(aist_vh_program.ipynb) and run it from the top. Put any action description in the last cell and run it to generate the action script.

※ Note that the [OpenAI](https://openai.com/) API is required for execution.

## Reproduction of evaluation experiments
1. Download the evaluation_program_and_data folder.
2. The folder contains the program for each experiment, a folder with scripts generated using the VirtualHome dataset (generated_vh_data) (divided into a folder with scripts generated by class name and a folder with scripts generated by object name), a folder with the correct data of VirtualHome dataset (correct_vh_data), a folder with scripts generated using KGRC4SI dataset (generated_kgrc_data), and a folder with correct data of KGRC4SI (correct_kgrc_data).

### LCS score
1. Open the jupyter file [lsc.ipynb](https://github.com/JinAoyama/actionscript_generate_in_vh/blob/main/evaluation_program_and_data/lcs.ipynb).
2. Since the path to the target data has been specified in advance, execution is performed in the same hierarchy as the above folder.
3. The data to be evaluated is noted in markdown above the cell for which the evaluation value is calculated.

The evaluation values for each experiment can be found in the output history of [lsc.ipynb](https://github.com/JinAoyama/actionscript_generate_in_vh/blob/main/evaluation_program_and_data/lcs.ipynb).

### Corecteness
1. Open the jupyter file [correctness.ipynb](https://github.com/JinAoyama/actionscript_generate_in_vh/blob/main/evaluation_program_and_data/correctness.ipynb).
2. Since the path to the target data has been specified in advance, execution is performed in the same hierarchy as the above folder.
3. The data to be evaluated is noted in markdown above the cell for which the evaluation value is calculated.

The evaluation values for each experiment can be found in the output history of [correctness.ipynb](https://github.com/JinAoyama/actionscript_generate_in_vh/blob/main/evaluation_program_and_data/correctness.ipynb).

### Simlator(execution rate)
1. Only this evaluation requires the VirtualHome simulator.
2. Run VirtualHome.exe and Open the jupyter file [sim.ipynb](https://github.com/JinAoyama/actionscript_generate_in_vh/blob/main/evaluation_program_and_data/sim.ipynb).
3. Select the VirtualHome scene in the top cell.
4. Select the evaluation data. Each data name ends with a scene number, so select the file path corresponding to the scene selected in 3. to load the data.
5. Execute the bottom cell to measure execution rate.

※　Longer execution times are expected, and bugs may occur along the way due to VirtualHome issues.

Since agents are randomly placed in the environment, it is known that some scripts may or may not be executed depending on the initial location of the agent. Therefore, we do not necessarily obtain the same results, but the experimental values are shown below. 
- generated_vh_data(object): Average of 99.2% for each scene.
- generated_vh_data(class): Average of 55.3% for each scene.
- generated_kgrc_data: Average of 87.2% for each scene.

### Supplement
The dataset used is in the folder ~.
